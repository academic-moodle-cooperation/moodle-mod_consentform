define(["jquery","core/config","core/log"],function(a,b,c){var d=function(){this.showlegendstring="",this.hidelegendstring=""},e=new d;return e.init=function(d){function f(){var b=a("#slot_overview tbody"),c=a("#show_past_slots").is(":checked"),d=a("#show_my_slots_only").is(":checked"),e=a("#show_free_slots_only").is(":checked"),f=a("#show_hidden_slots").is(":checked");b.hide(),b.find("tr").show(),f||b.find("tr:not(.info).unavailable").hide(),c||b.find("tr.past_due").hide(),d&&b.find("tr.not_my_slot").hide(),e&&b.find("tr.not_free_slot").hide(),b.show(),g(),i("mod_organizer_showhiddenslots",f),i("mod_organizer_showmyslotsonly",d),i("mod_organizer_showfreeslotsonly",e),i("mod_organizer_showpasttimeslots",c)}function g(){var b=a("#slot_overview tbody"),c=b.find("tr:not(.info)"),d=0===c.length,e=!1;c.each(function(){0===a(this).css("offsetWidth")&&0===a(this).css("offsetHeight")&&"none"!==a(this).css("display")||(e=!0)});var f=a("#show_past_slots").is(":checked"),g=a("#show_my_slots_only").is(":checked");b.find("tr.info").hide(),e||(d?b.find("tr.no_slots_defined").show():f&&!g?b.find("tr.no_slots").show():f&&g?b.find("tr.no_my_slots").show():!f&&g?b.find("tr.no_due_my_slots").show():b.find("tr.no_due_slots").show())}function h(){a("#infobox_legend_box").toggle(),a("#toggle_legend").val(function(){return a(this).val()==e.hidelegendstring?e.showlegendstring:e.hidelegendstring})}function i(d,e){var f={method:"get",url:b.wwwroot+"/lib/ajax/setuserpref.php",data:{sesskey:b.sesskey,pref:encodeURI(d),value:encodeURI(e)},dataType:"json",beforeSend:function(){c.info("set user preference "+d+": "+e,"organizer")},success:function(){c.info("set user preference OK","organizer")},error:function(){c.error("set user preference FAILED","organizer")}};a.ajax(f)}e.showlegendstring=d.showlegendstring,e.hidelegendstring=d.hidelegendstring,a("#show_past_slots").on("click",f),a("#show_my_slots_only").on("click",f),a("#show_free_slots_only").on("click",f),a("#show_hidden_slots").on("click",f),a("#toggle_legend").on("click",h),f()},e});